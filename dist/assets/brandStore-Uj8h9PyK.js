import{B as L,l as o,c as n}from"./index-1ucue018.js";const N=L("brand",()=>{const s=o([]),u=o(!1),l=o(null),c=o(!1),t=o({search:"",categoryId:"",alphabet:"",country:"",hasProducts:!1,featured:!1}),i=o("name-asc"),y=n(()=>s.value.filter(e=>e.is_own===!0)),p=n(()=>s.value.filter(e=>e.is_own!==!0)),h=n(()=>s.value.filter(e=>e.is_featured===!0)),m=n(()=>{const e=s.value.map(r=>r.category).filter(r=>!!r);return[...new Set(e)].sort()}),w=n(()=>{const e=s.value.map(r=>r.country).filter(r=>!!r);return[...new Set(e)].sort()}),B=n(()=>"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")),f=n(()=>{let e=[...s.value];if(t.value.search){const r=t.value.search.toLowerCase();e=e.filter(a=>{var d,v;return a.name.toLowerCase().includes(r)||((d=a.description)==null?void 0:d.toLowerCase().includes(r))||((v=a.country)==null?void 0:v.toLowerCase().includes(r))})}return t.value.categoryId&&(e=e.filter(r=>r.category===t.value.categoryId)),t.value.alphabet&&(e=e.filter(r=>r.name.charAt(0).toUpperCase()===t.value.alphabet)),t.value.country&&(e=e.filter(r=>r.country===t.value.country)),t.value.hasProducts&&(e=e.filter(r=>(r.product_count||0)>0)),t.value.featured&&(e=e.filter(r=>r.is_featured===!0)),e}),g=n(()=>{const e=[...f.value];switch(i.value){case"name-asc":e.sort((r,a)=>r.name.localeCompare(a.name,"zh-CN"));break;case"name-desc":e.sort((r,a)=>a.name.localeCompare(r.name,"zh-CN"));break;case"featured":e.sort((r,a)=>r.is_featured===a.is_featured?(r.priority||999)-(a.priority||999):r.is_featured?-1:1);break;case"priority":e.sort((r,a)=>(r.priority||999)-(a.priority||999));break}return e}),C=n(()=>{let e=0;return t.value.search&&e++,t.value.categoryId&&e++,t.value.alphabet&&e++,t.value.country&&e++,t.value.hasProducts&&e++,t.value.featured&&e++,e});async function b(){if(!(c.value&&s.value.length>0)){u.value=!0,l.value=null;try{const e=await fetch("/data/brands.json");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);s.value=await e.json(),c.value=!0}catch(e){l.value=e instanceof Error?e.message:"加载品牌数据失败",console.error("加载品牌数据失败:",e)}finally{u.value=!1}}}function I(e){return s.value.find(r=>r.id===e)}function _(e){return s.value.find(r=>r.name===e)}function k(e,r){t.value[e]=r}function P(){t.value={search:"",categoryId:"",alphabet:"",country:"",hasProducts:!1,featured:!1}}function S(e){i.value=e}return{brands:s,loading:u,error:l,initialized:c,filters:t,sortBy:i,ownBrands:y,selectedBrands:p,featuredBrands:h,allCategories:m,allCountries:w,alphabetIndex:B,filteredBrands:f,sortedBrands:g,activeFiltersCount:C,loadBrands:b,getBrandById:I,getBrandByName:_,setFilter:k,clearAllFilters:P,setSortBy:S}});export{N as u};
