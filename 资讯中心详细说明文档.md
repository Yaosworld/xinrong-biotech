# 资讯中心（促销中心）详细说明文档

## 一、资讯中心概述

### 1.1 功能定位
资讯中心（PromotionCenter），也称为促销中心，是企业官网展示最新优惠活动和促销信息的核心模块。通过该模块，用户可以及时了解公司的产品优惠、促销活动和特价信息。

### 1.2 核心功能
- **活动展示**：列表化展示所有促销活动
- **搜索功能**：支持标题、摘要、描述的全文搜索
- **状态管理**：自动计算活动状态（即将结束、正在进行、即将开始、已结束）
- **分页功能**：支持分页浏览，可调整每页显示数量
- **详情查看**：查看活动详细信息和海报

### 1.3 文件结构
```
src/views/promotions/
├── PromotionCenter.vue      # 资讯中心列表页
└── PromotionDetail.vue      # 活动详情页

src/components/business/
└── NewsCard.vue            # 活动/新闻卡片组件

src/stores/
└── promotionStore.ts       # 活动状态管理

public/data/
└── promotions.json         # 活动数据源
```

## 二、资讯中心列表页（PromotionCenter.vue）

### 2.1 页面布局结构

#### 2.1.1 展示区（ShowcaseBanner）
- **标语内容**：
  - "最新优惠活动"
  - "第一时间了解我们的产品优惠与促销信息"
- **统计数据**：
  - 进行中活动数量（动态计算）
  - 活动分类数量（固定为5+）
  - 浏览次数（固定为10K+）

#### 2.1.2 搜索区
- **搜索框**：最大宽度2xl，居中显示
- **搜索提示**："搜索促销活动..."
- **功能**：支持Enter键快速搜索

#### 2.1.3 活动列表区
- **布局**：垂直列表，每个活动占用一个卡片
- **组件**：使用NewsCard组件展示单个活动
- **分页**：默认8条/页，支持16条/页

### 2.2 核心功能实现

#### 2.2.1 数据加载
```typescript
onMounted(async () => {
  await promotionStore.loadPromotions()
})
```

#### 2.2.2 搜索功能
```typescript
const handleSearch = () => {
  promotionStore.setFilter('search', searchInputValue.value.trim())
  searchQuery.value = searchInputValue.value.trim()
  goToPage(1)
}
```

#### 2.2.3 分页功能
```typescript
const { currentPageItems, paginationInfo, goToPage, setPageSize } = usePagination(
  computed(() => promotionStore.filteredPromotions),
  { initialPageSize: 8, scrollTarget: '.promotion-section' }
)
```

## 三、活动详情页（PromotionDetail.vue）

### 3.1 页面特性
- **三种布局模式**：
  1. 纯海报模式（只有海报，无文本）
  2. 纯文字模式（只有文本，无海报）
  3. 双栏布局模式（既有文本又有海报）

### 3.2 核心功能

#### 3.2.1 动态几何背景
- **生成15个几何形状**：随机大小、位置、动画
- **动画效果**：4种不同的浮动动画（geometricFloat1-4）
- **视觉效果**：渐变背景、阴影、边框光晕

#### 3.2.2 布局判断逻辑
```typescript
// 是否有海报
const hasPoster = computed(() => {
  return promotion.value?.poster_url && !posterError.value
})

// 是否有文本内容
const hasTextContent = computed(() => {
  return promotion.value?.description && promotion.value.description.trim().length > 0
})

// 布局模式判断
const posterOnly = computed(() => hasPoster.value && !hasTextContent.value)
const textOnly = computed(() => hasTextContent.value && !hasPoster.value)
const hasBothContent = computed(() => hasTextContent.value && hasPoster.value)
```

#### 3.2.3 内容展示
- **状态标签**：显示活动当前状态
- **日期范围**：格式化显示活动时间
- **描述分段**：按双换行符自动分段
- **标签系统**：显示活动相关标签

### 3.3 样式特点
- **玻璃态效果**：`backdrop-filter: blur(20px)`
- **渐变装饰**：页面背景和几何形状使用渐变色
- **响应式设计**：移动端自动切换为单列布局

## 四、活动状态管理（promotionStore.ts）

### 4.1 状态计算逻辑

#### 4.1.1 活动状态定义
- **即将结束（endingSoon）**：距离结束5天以内
- **正在进行（active）**：在活动时间内，距离结束超过5天
- **即将开始（coming）**：活动还未开始
- **已结束（ended）**：活动时间已过

#### 4.1.2 北京时间处理
```typescript
const getBeijingTime = (date?: Date): Date => {
  const d = date || new Date()
  // 转换为UTC时间，然后加上8小时偏移（北京时间）
  return new Date(d.getTime() + (d.getTimezoneOffset() * 60000) + (8 * 3600000))
}
```

#### 4.1.3 状态优先级排序
1. 即将结束（优先级0）
2. 正在进行（优先级1）
3. 即将开始（优先级2）
4. 已结束（优先级3）

### 4.2 Store结构

#### 4.2.1 State
```typescript
const promotions = ref<Promotion[]>([])  // 活动列表
const loading = ref(false)               // 加载状态
const error = ref<string | null>(null)    // 错误信息
const initialized = ref(false)           // 初始化标记
const filters = ref<PromotionFilters>({   // 筛选条件
  search: ''
})
```

#### 4.2.2 Getters
- **processedPromotions**：处理后的活动（带状态）
- **sortedPromotions**：按优先级排序的活动
- **filteredPromotions**：筛选后的活动
- **activePromotions**：进行中的活动
- **comingPromotions**：即将开始的活动
- **endedPromotions**：已结束的活动
- **featuredPromotions**：推荐活动

#### 4.2.3 Actions
- **loadPromotions()**：加载活动数据
- **getPromotionById(id)**：根据ID获取活动
- **getPromotionCoverPath()**：获取封面图路径
- **getPromotionPosterPath()**：获取海报图路径
- **setFilter()**：设置筛选条件
- **clearAllFilters()**：清空筛选

## 五、活动卡片组件（NewsCard.vue）

### 5.1 组件特性
- **布局**：横向卡片，左侧图片，右侧内容
- **固定高度**：200px，确保所有卡片一致
- **响应式**：移动端自动切换为纵向布局

### 5.2 核心功能

#### 5.2.1 状态显示
- **状态标签**：右上角显示活动状态
- **状态颜色**：
  - 即将结束：橙色
  - 正在进行：绿色
  - 即将开始：蓝色
  - 已结束：灰色

#### 5.2.2 内容展示
- **封面图片**：280px宽，200px高
- **发布日期**：左上角显示
- **活动时间**：底部显示完整时间范围
- **标签系统**：最多显示3个标签

#### 5.2.3 交互效果
- **悬停效果**：阴影增强，边框高亮
- **蒙版层**：图片上的毛玻璃效果
- **点击跳转**：跳转到详情页

### 5.3 样式细节
- **边框**：黑色细边框，增强立体感
- **阴影**：多层次阴影效果
- **过渡动画**：所有变化都有平滑过渡

## 六、数据格式说明

### 6.1 活动数据结构（promotions.json）
```json
{
  "id": 1,                                // 活动ID
  "title": "活动标题",                    // 活动名称
  "summary": "活动摘要",                  // 简短描述
  "description": "详细描述",              // 详细内容（支持\n换行）
  "cover_url": "/images/promotions/...",  // 封面图
  "poster_url": "/images/promotions/...", // 海报图
  "icon_class": "fas fa-vial",           // 图标类名
  "publish_date": "2025-11-10",          // 发布日期
  "start_date": "2025-11-15",            // 开始日期
  "end_date": "2025-11-30",              // 结束日期
  "category": "化学试剂",                 // 活动分类
  "tags": ["标签1", "标签2"],             // 标签数组
  "is_featured": true,                   // 是否推荐
  "priority": 1                          // 排序优先级
}
```

### 6.2 图片资源管理
- **封面图**：`/public/images/promotions/covers/`
- **海报图**：`/public/images/promotions/posters/`
- **备用图**：`/images/common/placeholder.png`

## 七、路由配置

### 7.1 路由定义
```typescript
{
  path: '/news',
  name: 'PromotionCenter',
  component: () => import('@/views/promotions/PromotionCenter.vue'),
  meta: { title: '促销中心' }
},
{
  path: '/news/promotion/:id',
  name: 'PromotionDetail',
  component: () => import('@/views/promotions/PromotionDetail.vue'),
  meta: { title: '活动详情' }
}
```

### 7.2 导航菜单
- **菜单名称**：资讯中心
- **图标**：fas fa-newspaper
- **路径**：/news

## 八、性能优化

### 8.1 懒加载
- **路由懒加载**：使用动态导入
- **图片懒加载**：支持错误处理

### 8.2 计算缓存
- **状态缓存**：活动状态计算结果缓存
- **排序缓存**：排序结果缓存

### 8.3 优化策略
- **分页加载**：避免一次性渲染过多内容
- **虚拟滚动**：可在活动量大时考虑引入

## 九、扩展性设计

### 9.1 状态扩展
- 可轻松添加新的活动状态
- 状态优先级可配置

### 9.2 筛选扩展
- 可添加分类筛选
- 可添加日期范围筛选

### 9.3 展示扩展
- 支持更多布局模式
- 支持自定义主题

## 十、安全考虑

### 10.1 XSS防护
- 搜索高亮使用DOMPurify
- 描述内容使用v-html需谨慎

### 10.2 图片处理
- 加载失败有备用方案
- 路径限制在指定目录

## 十一、管理后台集成

### 11.1 数据管理
- 通过Excel批量更新活动数据
- 支持图片上传和管理

### 11.2 状态自动化
- 自动计算活动状态
- 无需手动维护

## 十二、总结

资讯中心（促销中心）作为一个独立的功能模块，具有以下特点：

1. **功能完整**：从列表展示到详情查看，功能完善
2. **状态智能**：自动计算和更新活动状态
3. **布局灵活**：支持多种展示模式
4. **交互友好**：流畅的动画和过渡效果
5. **性能优化**：分页、缓存、懒加载
6. **可维护性**：清晰的代码结构
7. **可扩展性**：易于添加新功能

该模块不仅展示了企业的促销活动，还通过精心设计的用户体验，有效地吸引了用户的注意力，提高了营销活动的转化率。